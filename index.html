<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script type="module" src="./main.js"></script>
    <link rel="shortcit icon" href="#">
    <link rel="stylesheet" href="layout.css">
</head>
<body>
<<<<<<< HEAD
    <script>
        // 계산기 DOM - node 생성 클래스(기본틀)
        class Calculator {
            constructor(Elem, ClsN) {
                this.container = document.createElement(Elem);
                this.container.className = ClsN;
                document.body.appendChild(this.container);
            }
            // 
            createNode(Elem, typ, nam, valu, text, ClsN, attr, wage) {
                this.btnPad = document.createElement(Elem)
                this.btnPad.value = valu;
                this.btnPad.className = ClsN;
                this.btnPad.type = typ;
                this.btnPad.name = nam;
                this.container.appendChild(this.btnPad);
                this.btnPad.setAttribute(attr, wage);
                this.PadText = document.createTextNode(text);
                this.btnPad.appendChild(this.PadText);
            }
        }
        // 계산기 DOM - node Generator(생성기)
        class NodeGenerator extends Calculator {
            constructor() {
                super("div", "Calculator");
            }

            createInputDisplay() {
                super.createNode('input', 'text', 'output', '', '', '', 'readonly', '');
            }

            createNumPad() {
                for (let i = 0; i <= 9; i++) {
                    super.createNode('button', '', '', `${i}`, `${i}`, 'btn', 'onclick', 'calculatorInput.btnInput(this)');
                }
            }
            createOperator() {
                super.createNode('button', '', '', '*', '*', 'operator', 'onclick', 'calculatorInput.btnPlusInput(this)');
                super.createNode('button', '', '', '/', '/', 'operator', 'onclick', 'calculatorInput.btnPlusInput(this)');
                super.createNode('button', '', '', '-', '-', 'operator', 'onclick', 'calculatorInput.btnPlusInput(this)');
                super.createNode('button', '', '', '+', '+', 'operator', 'onclick', 'calculatorInput.btnPlusInput(this)');
                super.createNode('button', '', '', '', 'AC', 'operator_Clear', 'onclick', 'calculatorInput.btnClearInput(this)');
                super.createNode('button', '', '', '=', '=', 'operator_result', 'onclick', 'calculatorInput.btnResultInput(this)');
            }

        }

        const extendedCal = new NodeGenerator();
        extendedCal.createInputDisplay()
        extendedCal.createNumPad();
        extendedCal.createOperator();



        // 계산기 버튼별 클릭시 onclick이벤트 실행 및 값 반환
        let calculatorInput = {
            btnInput: function (btn) {
                let buttonTag = btn.value;
                // document.getElementsByName("output")[0].value += buttonTag;
                // return (buttonTag);
                save.calcBefore.getBtnData(buttonTag)
            },
            btnPlusInput: function (operator) {
                let buttonTag = operator.value;
                // document.getElementsByName("output")[0].value += buttonTag;
                save.calcBefore.getBtnData(buttonTag)
                return buttonTag;
            },
            btnClearInput: function (operator_Clear) {
                let buttonTag = operator_Clear.value;
                save.calcBefore.resetArr(buttonTag);
                save.calcAfter.resetArr(buttonTag);
            },
            btnResultInput: function (operator_result) {
                let buttonTag = operator_result.value;
                // document.getElementsByName("output")[0].value += buttonTag;
                // return (buttonTag);

                // =을 누르면 계산 후 배열 초기화
                save.calcAfter.saveArr = [];
                verification.operator_Cal(buttonTag)
            }
        }



        // 광훈오빠 입력 데이터 -> save에 저장
        // 저장값은 민규오빠가 출력할 때 사용할 것

        // 저장
        const save = {
            calcBefore: {
                // 광훈오빠 객체 불러오기
                getBtnData: function (btn) {
                    // const data = calculatorInput.btnInput(btn); // 광훈오빠 객체로부터 데이터를 가져온다고 가정
                    const data = btn; // 광훈오빠 객체로부터 데이터를 가져온다고 가정
                    this.saveInArr(data); // saveInArr 함수 실행
                },

                // data 배열에 저장
                saveArr: [], // 빈 배열 만들기

                saveInArr: function (data) {
                    this.saveArr.push(data)
                    this.saveInLocalStorage();
                },

                resetArr: function (data) {
                    this.saveArr = [];
                    this.saveInLocalStorage();
                },

                // 로컬스트리지에 저장하려면 배열->스트링 변화 필요
                changeTypeToSaveLocalStorage: function () {
                    const string = JSON.stringify(this.saveArr);
                    return string;
                },

                // 로컬스토리지 저장
                saveInLocalStorage: function () {
                    const string = this.changeTypeToSaveLocalStorage();
                    window.localStorage.setItem("calcBefore", string);

                    // 배열에 있는 값 출력
                    printout.disPrint(save.calcBefore.saveArr);
                }
            },

            calcAfter: {
                // 민규오빠 객체 불러오기
                getCalcData: function (test) {
                    const data = test; // 광훈오빠 객체로부터 데이터를 가져온다고 가정
                    this.saveInArr(data); // saveInArr 함수 실행
                },

                // data 배열에 저장
                saveArr: [], // 빈 배열 만들기

                saveInArr: function (data) {
                    this.saveArr.push(data)
                    this.saveInLocalStorage();
                },

                resetArr: function (data) {
                    this.saveArr = [];
                    this.saveInLocalStorage();
                },

                // 로컬스트리지에 저장하려면 배열->스트링 변화 필요
                changeTypeToSaveLocalStorage: function () {
                    const string = JSON.stringify(this.saveArr);
                    return string;
                },

                // 로컬스토리지 저장
                saveInLocalStorage: function () {
                    const string = this.changeTypeToSaveLocalStorage();
                    window.localStorage.setItem("calcAfter", string);

                    // 배열에 있는 값 출력
                    printout.disPrint(save.calcAfter.saveArr);

                }
            }
        }

        // 연산 시작
        // 숫자와 연산 구분 작업
        let verification = {
            division: function () {
                let num1 = "";
                let num2 = "";
                let operatorFound = false;

                save.calcBefore.saveArr.forEach(item => {
                    // 연산자를 찾았을 때, 그 이후의 값들은 num2에 추가
                    if (item === "+" || item === "-" || item === "*" || item === "/") {
                        operatorFound = true;
                    } else {
                        if (operatorFound) {
                            num2 += item;
                        } else {
                            num1 += item;
                        }
                    }
                });
                return { num1, num2 };
            },

            // 연산하여 값 출력
            operator_Cal: function () {

                let num1 = Number(this.division().num1);    // 구분한 숫자들을 연산하기 위해 숫자로 인식하는 작업
                let num2 = Number(this.division().num2);
                let result;
                save.calcBefore.saveArr.forEach(item => {
                    if (item === "+" || item === "-" || item === "*" || item === "/") {
                        switch (item) {
                            case "+":
                                result = num1 + num2; // 결과값 반환하고 함수 실행 종료
                                break;
                            case "-":
                                result = num1 - num2;
                                break;
                            case "*":
                                result = num1 * num2;
                                break;
                            case "/":
                                if (num2 !== 0) {
                                    result = num1 / num2;
                                } else {
                                    result = "0으로 나눌 수 없습니다"
                                }
                                break;
                            default:
                                alert("잘못된 연산입니다."); // 잘못 입력 시
                                break;
                        }
                        save.calcAfter.getCalcData(result);
                    }
                });
            }
        }


        // 출력 객체
        const printout = {
            // 배열에서 값 가져오기
            getNum: function (data) {
                // const test = save.calcBefore.saveArr.join('');      // 배열 문자열로 바꿈
                const test = data.join('');      // 배열 문자열로 바꿈
                return test;
            },

            // 가져온 값 인풋에 넣기
            disPrint: function (data) {
                let input = document.getElementsByName("output")[0];
                input.value = this.getNum(data);
            }
        }

    </script>
=======
    
>>>>>>> 6a7dcbb2711895f988d04cebd978827617e95120
</body>
</html>